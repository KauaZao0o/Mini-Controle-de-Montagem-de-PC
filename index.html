<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mini - Controle de Montagem de PC</title>
  <style>
    :root{font-family:Inter, system-ui, Arial; --bg:#0f172a; --card:#0b1220; --accent:#10b981; --muted:#94a3b8}
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,#071229 0%, #071a2a 100%);color:#e6eef6;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
    .app{width:100%;max-width:820px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:20px;box-shadow:0 8px 30px rgba(2,6,23,0.6)}
    h1{margin:0 0 12px;font-size:20px}
    .step{display:none}
    .step.active{display:block}
    .grid{display:grid;gap:12px}
    .buttons{display:flex;gap:10px;flex-wrap:wrap}
    button.big{padding:14px 18px;border-radius:10px;border:0;background:#0b1220;color:var(--accent);cursor:pointer;font-weight:600}
    .option{background:rgba(255,255,255,0.03);padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.02);cursor:pointer}
    .option.selected{outline:3px solid rgba(16,185,129,0.12);border-color:rgba(16,185,129,0.4)}
    input[type=text], select{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:inherit}
    .top-row{display:flex;gap:12px;align-items:center}
    .muted{color:var(--muted);font-size:13px}
    .report{background:rgba(255,255,255,0.02);padding:12px;border-radius:10px;margin-top:12px;border:1px solid rgba(255,255,255,0.03)}
    .controls{display:flex;justify-content:space-between;align-items:center;margin-top:12px}
    .small{font-size:13px;color:var(--muted)}
    .hidden{display:none}
    .footer{margin-top:14px;display:flex;justify-content:flex-end}
    @media(max-width:600px){.top-row{flex-direction:column;align-items:stretch}}
  </style>
</head>
<body>
  <div class="app" role="application">
    <h1>Mini - Controle de Montagem de PC</h1>
    <div class="muted">Fluxo com um toque — clique nas opções para avançar. IDs únicos (salvos no navegador).</div>

    <!-- Pesquisa por ID -->
    <div style="margin-top:12px;display:flex;gap:8px;align-items:center;flex-wrap:wrap;">
      <input id="search-id" type="text" placeholder="Pesquisar por ID (ex: PC001)" style="padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:inherit;flex:1;min-width:180px" />
      <button id="search-btn" class="big" style="padding:10px 14px">Pesquisar</button>
      <div id="search-result" class="report" style="min-width:220px;display:none"></div>
    </div>

    <div id="wizard">
      <!-- Step 1: ID e Placa Mãe -->
      <div class="step active" id="step-1">
        <div class="grid">
          <label>ID do PC (único):
            <input id="pc-id" type="text" placeholder="Ex: PC001" />
          </label>
          <div>
            <div class="small muted">Escolha a placa-mãe (socket):</div>
            <div id="motherboard-options" class="buttons"></div>
          </div>
          <div class="controls">
            <div class="small">IDs salvos: <span id="saved-count">0</span></div>
            <div>
              <button id="step1-next" class="big">Confirmar e escolher processador</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Step 2: Processador -->
      <div class="step" id="step-2">
        <div class="grid">
          <div class="small muted">Processadores disponíveis para socket: <strong id="current-socket"></strong></div>
          <div id="cpu-options" class="buttons"></div>
          <div class="controls">
            <button id="step2-back" class="big">Voltar</button>
            <button id="step2-next" class="big">Confirmar e escolher frequência</button>
          </div>
        </div>
      </div>

      <!-- Step 3: Frequência -->
      <div class="step" id="step-3">
        <div class="grid">
          <div class="small muted">Escolha a frequência (GHz):</div>
          <div id="freq-options" class="buttons"></div>
          <div class="controls">
            <button id="step3-back" class="big">Voltar</button>
            <button id="step3-next" class="big">Confirmar e escolher memória</button>
          </div>
        </div>
      </div>

      <!-- Step 4: Memória -->
      <div class="step" id="step-4">
        <div class="grid">
          <div class="small muted">Tipo de memória disponível para o socket <strong id="mem-socket"></strong>:</div>
          <div id="memtype-options" class="buttons"></div>

          <div id="mem-config" class="hidden">
            <div class="small muted">Configuração de pentes (total definido automaticamente para alguns processadores):</div>
            <div id="memstick-options" class="buttons"></div>
          </div>

          <div class="controls">
            <button id="step4-back" class="big">Voltar</button>
            <button id="step4-next" class="big">Confirmar e escolher HD</button>
          </div>
        </div>
      </div>

      <!-- Step 5: HD -->
      <div class="step" id="step-5">
        <div class="grid">
          <div class="small muted">Escolha o HD:</div>
          <div id="hd-options" class="buttons"></div>
          <div class="controls">
            <button id="step5-back" class="big">Voltar</button>
            <button id="step5-next" class="big">Confirmar e escolher SO</button>
          </div>
        </div>
      </div>

      <!-- Step 6: Sistema Operacional -->
      <div class="step" id="step-6">
        <div class="grid">
          <div class="small muted">Escolha o Sistema Operacional:</div>
          <div id="os-options" class="buttons"></div>
          <div class="controls">
            <button id="step6-back" class="big">Voltar</button>
            <button id="step6-next" class="big">Finalizar e mostrar relatório</button>
          </div>
        </div>
      </div>

      <!-- Report -->
      <div class="step" id="step-7">
        <div class="grid">
          <h2>Relatório da montagem</h2>
          <div id="report" class="report"></div>
          <div class="controls">
            <button id="new-build" class="big">Nova montagem</button>
            <button id="download-report" class="big">Download JSON</button>
          </div>
        </div>
      </div>

    </div>
  </div>

  <script>
    // --- Dados do projeto ---
    const sockets = ['775','1156','1155','1150','1151','1700','1200'];
    const cpusBySocket = {
      '775':['Core2Duo','Dual Core','Core2Quad'],
      '1156':['Core i3','Core i5','Core i7'],
      '1155':['Core i3','Core i5','Core i7'],
      '1150':['Core i3','Core i5','Core i7'],
      '1151':['Core i3','Core i5','Core i7'],
      '1200':['Core i3','Core i5','Core i7','Core i9'],
      '1700':['Ryzen 3','Ryzen 5','Ryzen 7','Ryzen 9']
    };

    const freqByCpu = {
      'Core2Duo':['1.6','1.8','2.0','2.4','2.66'],
      'Dual Core':['1.8','2.0','2.2','2.6'],
      'Core2Quad':['2.4','2.66','2.83'],
      'Core i3':['2.4','2.6','3.0'],
      'Core i5':['2.6','2.8','3.0','3.4'],
      'Core i7':['2.8','3.0','3.6','4.0'],
      'Core i9':['3.1','3.4','3.8','4.2'],
      'Ryzen 3':['2.6','3.0','3.6'],
      'Ryzen 5':['2.8','3.2','3.6','4.0'],
      'Ryzen 7':['3.0','3.6','4.0','4.2'],
      'Ryzen 9':['3.4','3.8','4.2','4.6']
    };

    const memTypesBySocket = {
      '775':['DDR2','DDR3'],
      // sockets modernos => DDR4 (simplificação)
      'default':['DDR4']
    };

    const hdOptions = ['160GB','250GB','320GB','500GB'];
    const osOptions = ['Windows 10','Windows 11'];

    // Estado da montagem
    let build = {
      id:null, socket:null, cpu:null, freq:null, memType:null, memConfig:null, hd:null, os:null
    };

    // Helper: localStorage para armazenar IDs e builds
    const STORE_KEY = 'pc-montagens';
    function loadSaved(){
      try{const raw = localStorage.getItem(STORE_KEY); return raw?JSON.parse(raw):[] }catch(e){return[]}
    }
    function saveBuild(b){const arr = loadSaved(); arr.push(b); localStorage.setItem(STORE_KEY, JSON.stringify(arr));}
    function hasId(id){return loadSaved().some(x=>x.id===id)}

    // UI referências
    const savedCount = document.getElementById('saved-count');
    function updateSavedCount(){savedCount.textContent = loadSaved().length}
    updateSavedCount();

    // Criar botões de socket
    const mbContainer = document.getElementById('motherboard-options');
    sockets.forEach(s=>{
      const b = document.createElement('button'); b.type='button'; b.className='option'; b.textContent=s; b.dataset.socket=s;
      b.addEventListener('click', ()=>{
        selectOptionGroup(mbContainer,b,'socket');
      });
      mbContainer.appendChild(b);
    });

    function selectOptionGroup(container,button,key){
      // desmarca todos
      Array.from(container.children).forEach(c=>c.classList.remove('selected'));
      button.classList.add('selected');
      // atualiza estado conforme o key solicitado
      if(key==='socket'){
        build.socket = button.dataset.socket;
        document.getElementById('current-socket').textContent = build.socket;
        document.getElementById('mem-socket').textContent = build.socket;
        // quando trocar socket, limpa etapas seguintes
        build.cpu = build.freq = build.memType = build.memConfig = null;
        clearSelection(document.getElementById('cpu-options'));
        clearSelection(document.getElementById('freq-options'));
        clearSelection(document.getElementById('memtype-options'));
        hide(document.getElementById('mem-config'));
      } else if(key==='cpu'){
        build.cpu = button.dataset.cpu;
        build.freq = null; clearSelection(document.getElementById('freq-options'));
      } else if(key==='freq'){
        build.freq = button.dataset.freq;
      } else if(key==='memtype'){
        build.memType = button.dataset.memtype;
      } else if(key==='memstick'){
        build.memConfig = button.dataset.mem;
      } else if(key==='hd'){
        build.hd = button.dataset.hd;
      } else if(key==='os'){
        build.os = button.dataset.os;
      }
    }

    function clearSelection(container){Array.from(container.children).forEach(c=>c.classList.remove('selected'))}
    function hide(el){el.classList.add('hidden')}
    function show(el){el.classList.remove('hidden')}

    // Navegação entre passos
    function goTo(stepNum){
      Array.from(document.querySelectorAll('.step')).forEach(s=>s.classList.remove('active'));
      document.getElementById('step-'+stepNum).classList.add('active');
    }

    // Step1 next: validate id & socket
    document.getElementById('step1-next').addEventListener('click', ()=>{
      const id = document.getElementById('pc-id').value.trim();
      if(!id){alert('Informe um ID para o PC (por exemplo PC001)'); return}
      if(hasId(id)){alert('ID já existe. Escolha outro.'); return}
      const socket = build.socket;
      if(!socket){alert('Escolha uma placa-mãe (socket)'); return}
      build.id = id;
      // avancar
      populateCPUOptions(socket);
      goTo(2);
    });

    document.getElementById('step2-back').addEventListener('click', ()=>goTo(1));
    document.getElementById('step2-next').addEventListener('click', ()=>{
      if(!build.cpu){alert('Escolha o processador'); return}
      populateFreqOptions(build.cpu);
      goTo(3);
    });

    document.getElementById('step3-back').addEventListener('click', ()=>goTo(2));
    document.getElementById('step3-next').addEventListener('click', ()=>{
      if(!build.freq){alert('Escolha a frequência'); return}
      populateMemOptions(build.socket, build.cpu);
      goTo(4);
    });

    document.getElementById('step4-back').addEventListener('click', ()=>goTo(3));
    document.getElementById('step4-next').addEventListener('click', ()=>{
      if(!build.memType || !build.memConfig){alert('Escolha o tipo de memória e a configuração de pentes'); return}
      populateHDOptions();
      goTo(5);
    });

    document.getElementById('step5-back').addEventListener('click', ()=>goTo(4));
    document.getElementById('step5-next').addEventListener('click', ()=>{
      if(!build.hd){alert('Escolha o HD'); return}
      populateOSOptions();
      goTo(6);
    });

    document.getElementById('step6-back').addEventListener('click', ()=>goTo(5));
    document.getElementById('step6-next').addEventListener('click', ()=>{
      if(!build.os){alert('Escolha o sistema operacional'); return}
      // salvar montagem
      saveBuild({...build, timestamp: new Date().toISOString()});
      updateSavedCount();
      showReport();
      goTo(7);
    });

    document.getElementById('new-build').addEventListener('click', ()=>{
      // reset
      build = {id:null,socket:null,cpu:null,freq:null,memType:null,memConfig:null,hd:null,os:null};
      document.getElementById('pc-id').value='';
      clearSelection(mbContainer); clearSelection(document.getElementById('cpu-options'));
      clearSelection(document.getElementById('freq-options'));
      clearSelection(document.getElementById('memtype-options'));
      clearSelection(document.getElementById('memstick-options'));
      hide(document.getElementById('mem-config'));
      goTo(1);
    });

    document.getElementById('download-report').addEventListener('click', ()=>{
      const data = JSON.stringify(loadSaved(), null, 2);
      const blob = new Blob([data], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href=url; a.download='montagens.json'; a.click(); URL.revokeObjectURL(url);
    });

    // --- Populadores de opções ---
    function populateCPUOptions(socket){
      const container = document.getElementById('cpu-options'); container.innerHTML='';
      const list = cpusBySocket[socket] || ['Generic CPU'];
      list.forEach(cpu=>{
        const b = document.createElement('button'); b.type='button'; b.className='option'; b.textContent=cpu; b.dataset.cpu=cpu;
        b.addEventListener('click', ()=>{ selectOptionGroup(container,b,'cpu') });
        container.appendChild(b);
      });
      document.getElementById('current-socket').textContent = socket;
    }

    function populateFreqOptions(cpu){
      const container = document.getElementById('freq-options'); container.innerHTML='';
      const list = freqByCpu[cpu] || ['2.0','3.0'];
      list.forEach(f=>{
        const b = document.createElement('button'); b.type='button'; b.className='option'; b.textContent=f+' GHz'; b.dataset.freq=f;
        b.addEventListener('click', ()=>{ selectOptionGroup(container,b,'freq') });
        container.appendChild(b);
      });
    }

    function populateMemOptions(socket, cpu){
      const container = document.getElementById('memtype-options'); container.innerHTML='';
      const types = memTypesBySocket[socket] || memTypesBySocket['default'];
      types.forEach(m=>{
        const b = document.createElement('button'); b.type='button'; b.className='option'; b.textContent=m; b.dataset.memtype=m;
        b.addEventListener('click', ()=>{ selectOptionGroup(container,b,'memtype'); prepareMemSticks(socket,cpu); show(document.getElementById('mem-config')) });
        container.appendChild(b);
      });
      // prepare memory sticks hidden until memtype chosen
      hide(document.getElementById('mem-config'));
    }

    function prepareMemSticks(socket, cpu){
      const container = document.getElementById('memstick-options'); container.innerHTML='';
      // regra: se cpu pertence a Core2Duo/Dual Core/Core2Quad => total 4GB (exemplo do usuário)
      const legacy = ['Core2Duo','Dual Core','Core2Quad'];
      if(legacy.includes(cpu)){
        const opts = ['2x2GB (total 4GB)','4x1GB (total 4GB)'];
        opts.forEach(o=>{ const b=document.createElement('button'); b.className='option'; b.textContent=o; b.dataset.mem=o; b.addEventListener('click', ()=>selectOptionGroup(container,b,'memstick')); container.appendChild(b)});
      } else {
        // opções genéricas: 8GB, 16GB, 32GB com combinações
        const opts = ['1x8GB (8GB)','2x8GB (16GB)','2x16GB (32GB)'];
        opts.forEach(o=>{ const b=document.createElement('button'); b.className='option'; b.textContent=o; b.dataset.mem=o; b.addEventListener('click', ()=>selectOptionGroup(container,b,'memstick')); container.appendChild(b)});
      }
    }

    function populateHDOptions(){
      const container = document.getElementById('hd-options'); container.innerHTML='';
      hdOptions.forEach(h=>{const b=document.createElement('button'); b.className='option'; b.textContent=h; b.dataset.hd=h; b.addEventListener('click', ()=>selectOptionGroup(container,b,'hd')); container.appendChild(b)});
    }

    function populateOSOptions(){
      const container = document.getElementById('os-options'); container.innerHTML='';
      osOptions.forEach(o=>{const b=document.createElement('button'); b.className='option'; b.textContent=o; b.dataset.os=o; b.addEventListener('click', ()=>selectOptionGroup(container,b,'os')); container.appendChild(b)});
    }

    function showReport(){
      const r = document.getElementById('report'); r.innerHTML='';
      const html = `
        <div><strong>ID:</strong> ${build.id}</div>
        <div><strong>Placa-mãe (socket):</strong> ${build.socket}</div>
        <div><strong>Processador:</strong> ${build.cpu} @ ${build.freq} GHz</div>
        <div><strong>Memória:</strong> ${build.memType} — ${build.memConfig}</div>
        <div><strong>HD:</strong> ${build.hd}</div>
        <div><strong>Sistema Operacional:</strong> ${build.os}</div>
        <div class="small muted">Salvo em: ${new Date().toLocaleString()}</div>
      `;
      r.innerHTML = html;
    }

    // Função de busca por ID e exibição de informações
    function findBuildById(id){
      const arr = loadSaved();
      return arr.find(x => x.id.toLowerCase() === id.toLowerCase()) || null;
    }

    function showSearchResult(found){
      const el = document.getElementById('search-result');
      if(!found){ el.style.display='block'; el.innerHTML = '<div class="small muted">Nenhum registro encontrado para esse ID.</div>'; return }
      el.style.display='block';
      el.innerHTML = `
        <div><strong>ID:</strong> ${found.id}</div>
        <div><strong>Socket:</strong> ${found.socket}</div>
        <div><strong>CPU:</strong> ${found.cpu} @ ${found.freq} GHz</div>
        <div><strong>Memória:</strong> ${found.memType} — ${found.memConfig}</div>
        <div><strong>HD:</strong> ${found.hd}</div>
        <div><strong>SO:</strong> ${found.os}</div>
        <div class="small muted">Salvo em: ${new Date(found.timestamp).toLocaleString()}</div>
      `;
    }

    document.getElementById('search-btn').addEventListener('click', ()=>{
      const q = document.getElementById('search-id').value.trim();
      if(!q){ alert('Digite um ID para pesquisar'); return }
      const found = findBuildById(q);
      showSearchResult(found);
    });

    // Permitir pesquisar ao pressionar Enter
    document.getElementById('search-id').addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ document.getElementById('search-btn').click(); } });

    // Ao carregar, popular contadores
    updateSavedCount();

    // Dica: clique direto nas opções — o fluxo é com "um toque". O botão "Confirmar..." avança quando tudo estiver selecionado.
  </script>
</body>
</html>
